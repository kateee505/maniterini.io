<!DOCTYPE html>
<html lang="lv">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>TÄ“riÅ†u PÄrskats</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>

<div class="app">

  <!-- WELCOME -->
  <section class="card welcome">
    <h1>Sveiki!</h1>
    <p>Ko tu esi iztÄ“rÄ“jis?</p>
    <button class="btn btn-dark" onclick="goToChart()">
      Uz tÄ“riÅ†u pÄrskatu
    </button>
  </section>

  <!-- CHART -->
  <section class="card stats" id="chart">
    <h2>TÄ“riÅ†u sadalÄ«jums</h2>

    <div class="chart" id="pie"></div>

    <div class="legend" id="legend"></div>

    <button class="btn btn-yellow" onclick="openModal()">
      + Pievienot tÄ“riÅ†us
    </button>
  </section>

  <!-- SETTINGS -->
  <section class="card welcome">
    <h2>IestatÄ«jumi</h2>
    <button class="btn btn-dark" onclick="openHelp()">
      PalÄ«dzÄ«ba
    </button>
  </section>

</div>

<!-- MODAL -->
<div class="modal" id="modal">
  <div class="modal-box">
    <span class="close" onclick="closeModal()">Ã—</span>
    <h3>Pievienot tÄ“riÅ†us</h3>

    <input type="number" id="amount" placeholder="Summa â‚¬">

    <select id="category">
      <option value="Pirkumi">ğŸ›’ Pirkumi</option>
      <option value="Online">ğŸ’» Online pirkumi</option>
      <option value="Ä’diens">ğŸ½ Ä’diens</option>
      <option value="Abonementi">ğŸ“º Abonementi</option>
      <option value="KomunÄlie">ğŸ  KomunÄlie maksÄjumi</option>
      <option value="PÄrskaitÄ«jumi">ğŸ’¸ PÄrskaitÄ«jumi cilvÄ“kiem</option>
    </select>

    <button class="btn btn-dark" onclick="addExpense()">
      SaglabÄt
    </button>
  </div>
</div>

<!-- HELP -->
<div class="help" id="help">
  <h1>MÄ“s nezinÄm, kÄ jums palÄ«dzÄ“t</h1>
  <button class="btn btn-dark" onclick="closeHelp()">Atgriezties</button>
</div>

<script>
const categories = {
  Pirkumi: { value: 0, color: "#60a5fa", icon: "ğŸ›’", name: "Pirkumi" },
  Online: { value: 0, color: "#38bdf8", icon: "ğŸ’»", name: "Online pirkumi" },
  Ä’diens: { value: 0, color: "#4ade80", icon: "ğŸ½", name: "Ä’diens" },
  Abonementi: { value: 0, color: "#f87171", icon: "ğŸ“º", name: "Abonementi" },
  KomunÄlie: { value: 0, color: "#facc15", icon: "ğŸ ", name: "KomunÄlie maksÄjumi" },
  PÄrskaitÄ«jumi: { value: 0, color: "#c084fc", icon: "ğŸ’¸", name: "PÄrskaitÄ«jumi cilvÄ“kiem" }
};

function openModal() {
  modal.style.display = "flex";
}

function closeModal() {
  modal.style.display = "none";
}

function addExpense() {
  const amount = +amountInput.value;
  const category = categorySelect.value;
  if (!amount) return;

  categories[category].value += amount;
  updateChart();
  closeModal();
}

function updateChart() {
  const total = Object.values(categories).reduce((s,c)=>s+c.value,0);
  if (!total) return;

  let current = 0;
  let gradient = [];
  let legendHTML = "";

  Object.values(categories).forEach(c => {
    if (!c.value) return;
    const start = current;
    const percent = (c.value / total) * 100;
    current += percent;

    gradient.push(`${c.color} ${start}% ${current}%`);

    legendHTML += `
      <div class="legend-item">
        <span class="dot" style="background:${c.color}"></span>
        ${c.icon} ${c.name} â€” ${percent.toFixed(1)}%
      </div>
    `;
  });

  pie.style.background = `conic-gradient(${gradient.join(",")})`;
  legend.innerHTML = legendHTML;
}

function goToChart() {
  chart.scrollIntoView({ behavior: "smooth" });
}

function openHelp() {
  help.style.display = "flex";
}

function closeHelp() {
  help.style.display = "none";
}

const modal = document.getElementById("modal");
const pie = document.getElementById("pie");
const legend = document.getElementById("legend");
const amountInput = document.getElementById("amount");
const categorySelect = document.getElementById("category");
</script>

</body>
</html>

